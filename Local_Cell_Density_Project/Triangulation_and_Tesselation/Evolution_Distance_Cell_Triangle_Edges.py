import numpy as np
import scipy.spatial as sp
import matplotlib.pyplot as plt
from itertools import chain
from Local_Cell_Density_Project.SegClass_HDF_Output_Files.HDF_Format_Old.Explore_HDF5_File_Functions import *
from Movie_Analysis_Pipeline.Single_Movie_Processing.Movie_Frame_Length import FindMovieLength
from Movie_Analysis_Pipeline.Single_Movie_Processing.Server_Movies_Paths import GetMovieFilesPaths

#hdf5_file = '/Volumes/lowegrp/Data/Kristina/MDCK_90WT_10Sc_NoComp/17_07_24/pos13/HDF/segmented.hdf5'

def CalculateTriangleEdgesPerFrame(hdf5_file, frame):
    x_gfp, y_gfp, x_rfp, y_rfp = GetXandYcoordinatesPerFrame(hdf5_file=hdf5_file, frame=frame)

    # Create coordinates irrespective of cell count per FOV:
    coordinates = []
    for x, y in zip(x_gfp + x_rfp, y_gfp + y_rfp):
        coordinates.append([x, y])

    # Triangulate:
    coordinates = np.array(coordinates)
    try:
        tri = sp.Delaunay(coordinates)
        triangles_all = coordinates[tri.simplices]
        edges = []

        for triangle in triangles_all:
            a_x = triangle[0][0]
            a_y = triangle[0][1]
            b_x = triangle[1][0]
            b_y = triangle[1][1]
            c_x = triangle[2][0]
            c_y = triangle[2][1]

            a_edge = np.sqrt((b_x - c_x) ** 2 + (b_y - c_y) ** 2)
            b_edge = np.sqrt((a_x - c_x) ** 2 + (a_y - c_y) ** 2)
            c_edge = np.sqrt((a_x - b_x) ** 2 + (a_y - b_y) ** 2)

            edges.append(a_edge)
            edges.append(b_edge)
            edges.append(c_edge)

        return coordinates, edges

    except:
        return [], []


def CalculateTriangleEdgesPerMovie(hdf5_file):
    """

    :param exp_type:
    :param data_date:
    :param pos:
    :return:
    """

    # Figure out the length of the analysed movie:
    exp_type, data_date, pos = hdf5_file.split("/")[-5], hdf5_file.split("/")[-4], hdf5_file.split("/")[-3]
    movie_length = FindMovieLength(exp_type=exp_type, data_date=data_date, pos=pos)

    # Create the lists which will be returned:
    cell_count = list(range(0, 2500 + 1))           # TODO: There can't possibly be more than 1200 cells per FOV!
    dist_mean_list = [[] for _ in cell_count]
    dist_stdv_list = [[] for _ in cell_count]

    for frame in range(movie_length):
        if frame % 50 == 0:
            print ("Processing frame #{}".format(frame))
        coordinates, edges = CalculateTriangleEdgesPerFrame(hdf5_file=hdf5_file, frame=frame)
        idx = cell_count.index(len(coordinates))
        dist_mean_list[idx].append(np.mean(edges))
        dist_stdv_list[idx].append(np.std(edges))

    return dist_mean_list, dist_stdv_list


def CalculateTriangleEdgesOverall():
    """

    :return:
    """

    # Iterate through datasets:
    cell_count = list(range(0, 2500 + 1))
    means_overall = [[] for _ in cell_count]
    stdev_overall = [[] for _ in cell_count]

    for dataset in ["MDCK_WT_Pure", "MDCK_Sc_Tet-_Pure", "MDCK_90WT_10Sc_NoComp"]:
    #for dataset in ["MDCK_90WT_10Sc_NoComp"]:
        xml_file_list, _ = GetMovieFilesPaths(exp_type=dataset)
        for xml_file in xml_file_list:
            if "tracks_type1.xml" in xml_file:
                hdf5_file = xml_file.replace("tracks/tracks_type1.xml", "HDF/segmented.hdf5")
                print ("Processing HDF file: {}".format(hdf5_file))
                dist_mean_list, dist_stdv_list = CalculateTriangleEdgesPerMovie(hdf5_file=hdf5_file)

                dist_mean_list = list(chain.from_iterable([[None] if item == [] else item for item in dist_mean_list]))
                dist_stdv_list = list(chain.from_iterable([[None] if item == [] else item for item in dist_stdv_list]))

                for index, (mean, stdv) in enumerate(zip(dist_mean_list, dist_stdv_list)):
                    if mean is not None and stdv is not None:
                        #print (index, mean, stdv)
                        means_overall[index].append(mean)
                        stdev_overall[index].append(stdv)

    return cell_count, means_overall, stdev_overall


# Output lists:
#frames = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 540, 541, 542, 543, 544, 545, 546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560, 561, 562, 563, 564, 565, 566, 567, 568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584, 585, 586, 587, 588, 589, 590, 591, 592, 593, 594, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608, 609, 610, 611, 612, 613, 614, 615, 616, 617, 618, 619, 620, 621, 622, 623, 624, 625, 626, 627, 628, 629, 630, 631, 632, 633, 634, 635, 636, 637, 638, 639, 640, 641, 642, 643, 644, 645, 646, 647, 648, 649, 650, 651, 652, 653, 654, 655, 656, 657, 658, 659, 660, 661, 662, 663, 664, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679, 680, 681, 682, 683, 684, 685, 686, 687, 688, 689, 690, 691, 692, 693, 694, 695, 696, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 714, 715, 716, 717, 718, 719, 720, 721, 722, 723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733, 734, 735, 736, 737, 738, 739, 740, 741, 742, 743, 744, 745, 746, 747, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 780, 781, 782, 783, 784, 785, 786, 787, 788, 789, 790, 791, 792, 793, 794, 795, 796, 797, 798, 799, 800, 801, 802, 803, 804, 805, 806, 807, 808, 809, 810, 811, 812, 813, 814, 815, 816, 817, 818, 819, 820, 821, 822, 823, 824, 825, 826, 827, 828, 829, 830, 831, 832, 833, 834, 835, 836, 837, 838, 839, 840, 841, 842, 843, 844, 845, 846, 847, 848, 849, 850, 851, 852, 853, 854, 855, 856, 857, 858, 859, 860, 861, 862, 863, 864, 865, 866, 867, 868, 869, 870, 871, 872, 873, 874, 875, 876, 877, 878, 879, 880, 881, 882, 883, 884, 885, 886, 887, 888, 889, 890, 891, 892, 893, 894, 895, 896, 897, 898, 899, 900, 901, 902, 903, 904, 905, 906, 907, 908, 909, 910, 911, 912, 913, 914, 915, 916, 917, 918, 919, 920, 921, 922, 923, 924, 925, 926, 927, 928, 929, 930, 931, 932, 933, 934, 935, 936, 937, 938, 939, 940, 941, 942, 943, 944, 945, 946, 947, 948, 949, 950, 951, 952, 953, 954, 955, 956, 957, 958, 959, 960, 961, 962, 963, 964, 965, 966, 967, 968, 969, 970, 971, 972, 973, 974, 975, 976, 977, 978, 979, 980, 981, 982, 983, 984, 985, 986, 987, 988, 989, 990, 991, 992, 993, 994, 995, 996, 997, 998, 999, 1000, 1001, 1002, 1003, 1004, 1005, 1006, 1007, 1008, 1009, 1010, 1011, 1012, 1013, 1014, 1015, 1016, 1017, 1018, 1019, 1020, 1021, 1022, 1023, 1024, 1025, 1026, 1027, 1028, 1029, 1030, 1031, 1032, 1033, 1034, 1035, 1036, 1037, 1038, 1039, 1040, 1041, 1042, 1043, 1044, 1045, 1046, 1047, 1048, 1049, 1050, 1051, 1052, 1053, 1054, 1055, 1056, 1057, 1058, 1059, 1060, 1061, 1062, 1063, 1064, 1065, 1066, 1067, 1068, 1069, 1070, 1071, 1072, 1073, 1074, 1075, 1076, 1077, 1078, 1079, 1080, 1081, 1082, 1083, 1084, 1085, 1086, 1087, 1088, 1089, 1090, 1091, 1092, 1093, 1094, 1095, 1096, 1097, 1098, 1099, 1100, 1101, 1102, 1103, 1104]
#cell_count = [112, 115, 113, 115, 113, 113, 114, 112, 111, 111, 111, 112, 118, 118, 117, 116, 114, 111, 113, 114, 116, 114, 112, 114, 116, 112, 112, 114, 112, 113, 111, 113, 111, 113, 111, 84, 113, 111, 110, 112, 113, 112, 111, 111, 108, 111, 108, 109, 110, 108, 109, 110, 19, 111, 113, 114, 114, 115, 114, 112, 114, 114, 114, 114, 115, 115, 114, 113, 111, 95, 113, 114, 111, 114, 115, 116, 117, 116, 114, 118, 116, 113, 113, 117, 111, 114, 115, 114, 114, 113, 114, 116, 18, 116, 116, 117, 117, 117, 117, 118, 123, 120, 118, 122, 120, 19, 120, 119, 120, 120, 119, 118, 118, 122, 122, 122, 121, 122, 121, 123, 123, 125, 125, 125, 123, 121, 120, 123, 121, 122, 124, 125, 121, 22, 126, 122, 121, 124, 123, 123, 125, 124, 22, 23, 129, 127, 128, 129, 127, 128, 129, 130, 129, 130, 24, 132, 24, 24, 133, 130, 129, 131, 132, 129, 23, 130, 132, 129, 130, 130, 132, 132, 23, 132, 129, 129, 130, 130, 130, 129, 129, 23, 130, 134, 23, 132, 131, 131, 130, 129, 130, 129, 132, 132, 131, 131, 132, 131, 130, 132, 130, 132, 132, 133, 132, 133, 26, 132, 133, 131, 132, 131, 132, 134, 130, 135, 136, 136, 137, 137, 138, 139, 27, 134, 27, 135, 136, 136, 136, 136, 135, 136, 134, 138, 138, 136, 136, 137, 138, 138, 138, 141, 140, 138, 140, 140, 139, 138, 141, 142, 143, 144, 143, 144, 146, 150, 149, 146, 146, 147, 148, 147, 143, 149, 152, 148, 149, 149, 150, 28, 151, 150, 151, 154, 158, 155, 154, 154, 154, 154, 159, 157, 156, 158, 28, 28, 161, 159, 153, 156, 159, 158, 159, 166, 163, 166, 166, 169, 32, 33, 172, 174, 175, 174, 176, 33, 180, 182, 179, 178, 182, 182, 181, 181, 181, 182, 182, 184, 185, 188, 182, 180, 34, 190, 189, 179, 187, 184, 186, 185, 37, 193, 188, 194, 191, 194, 190, 195, 199, 192, 195, 198, 198, 196, 197, 201, 202, 199, 39, 199, 200, 199, 202, 200, 202, 203, 203, 39, 208, 208, 207, 210, 208, 41, 208, 211, 41, 209, 212, 211, 213, 220, 220, 221, 214, 214, 211, 215, 213, 216, 214, 216, 215, 218, 41, 221, 217, 220, 219, 221, 220, 222, 220, 222, 228, 220, 225, 230, 232, 224, 224, 228, 222, 231, 232, 234, 233, 226, 235, 235, 232, 45, 237, 233, 232, 235, 236, 234, 232, 232, 234, 234, 46, 232, 231, 236, 233, 234, 239, 233, 237, 234, 242, 240, 234, 238, 241, 240, 233, 242, 238, 242, 242, 241, 244, 241, 240, 244, 246, 242, 241, 245, 245, 242, 245, 254, 248, 244, 247, 254, 248, 257, 250, 260, 53, 256, 257, 257, 258, 258, 255, 262, 258, 260, 263, 263, 263, 266, 267, 263, 54, 262, 262, 270, 264, 268, 279, 276, 275, 284, 279, 285, 277, 286, 280, 57, 283, 287, 281, 287, 287, 288, 290, 288, 287, 290, 294, 291, 292, 291, 299, 301, 304, 62, 307, 308, 309, 309, 309, 307, 310, 308, 313, 317, 313, 311, 316, 312, 314, 313, 316, 318, 314, 66, 64, 309, 65, 311, 314, 307, 309, 307, 306, 308, 310, 310, 309, 315, 312, 311, 309, 308, 67, 321, 317, 320, 325, 327, 325, 325, 70, 70, 329, 328, 331, 329, 338, 337, 336, 334, 341, 340, 70, 338, 335, 343, 344, 343, 346, 345, 340, 336, 346, 343, 348, 341, 342, 350, 357, 351, 353, 352, 362, 356, 354, 359, 357, 364, 356, 368, 367, 366, 369, 367, 369, 368, 374, 377, 386, 384, 383, 377, 383, 381, 387, 391, 392, 384, 389, 383, 387, 398, 400, 410, 403, 408, 404, 416, 409, 413, 406, 406, 416, 415, 87, 423, 416, 426, 419, 432, 423, 427, 432, 430, 430, 431, 433, 434, 439, 429, 437, 431, 427, 443, 436, 428, 431, 437, 429, 439, 441, 441, 436, 446, 438, 89, 444, 442, 449, 447, 453, 444, 448, 447, 444, 447, 450, 460, 449, 448, 453, 455, 460, 463, 97, 462, 462, 464, 98, 472, 473, 468, 469, 466, 468, 98, 99, 479, 473, 478, 481, 472, 477, 475, 479, 477, 487, 481, 488, 485, 488, 499, 496, 110, 493, 507, 504, 506, 512, 511, 517, 516, 521, 519, 514, 527, 521, 530, 515, 532, 536, 112, 539, 549, 117, 117, 544, 548, 548, 541, 549, 554, 551, 557, 557, 551, 559, 558, 558, 563, 567, 564, 572, 571, 567, 570, 578, 124, 586, 582, 585, 589, 580, 587, 586, 585, 587, 584, 589, 587, 587, 590, 582, 583, 590, 583, 129, 583, 584, 589, 130, 595, 592, 589, 591, 597, 605, 597, 603, 613, 611, 607, 611, 620, 613, 617, 609, 614, 619, 620, 632, 623, 623, 627, 140, 627, 632, 631, 631, 630, 634, 636, 642, 651, 643, 644, 150, 652, 653, 658, 656, 656, 664, 667, 152, 670, 669, 670, 673, 676, 151, 669, 672, 685, 679, 685, 692, 699, 700, 700, 696, 693, 699, 702, 700, 703, 706, 705, 708, 714, 715, 708, 710, 713, 726, 717, 722, 736, 727, 735, 730, 738, 735, 741, 745, 746, 745, 750, 753, 752, 749, 757, 764, 760, 767, 767, 763, 763, 760, 763, 765, 762, 768, 772, 770, 773, 772, 774, 776, 775, 772, 781, 780, 779, 780, 780, 781, 786, 786, 781, 782, 788, 790, 798, 795, 789, 789, 794, 794, 794, 795, 797, 800, 797, 797, 805, 812, 812, 819, 816, 822, 820, 820, 825, 830, 827, 829, 828, 823, 188, 825, 827, 831, 830, 826, 830, 832, 835, 831, 830, 831, 833, 829, 832, 836, 837, 843, 833, 836, 837, 841, 833, 837, 847, 848, 850, 843, 850, 853, 853, 863, 859, 858, 195, 857, 863, 864, 857, 865, 869, 869, 870, 872, 881, 876, 872, 872, 872, 195, 879, 674, 878, 888, 889, 889, 890, 887, 200, 895, 900, 900, 897, 900, 902, 901, 905, 903, 907, 904, 904, 906, 906, 913, 204, 917, 912, 916, 918, 920, 920, 921, 923, 923, 924, 930, 931, 935, 936, 203, 935, 933, 933, 940, 941, 948, 946, 950, 954, 955, 952, 958, 960, 956, 957, 211, 962, 213, 212, 212, 971, 968, 967, 972, 975, 966, 972, 969, 974, 976, 975, 979, 980, 984, 986, 988, 986, 991, 992, 989, 219, 989, 991, 990, 995, 992, 1000, 999, 996, 991, 1004, 1001, 222, 1006, 1007, 1007, 1008, 1010, 1019, 1010, 1019, 1017, 1015, 1025, 1021, 1023, 1027, 1021, 227, 1018, 1028, 1022, 1025, 1030, 1031, 1036, 1033, 1038, 1038, 1040, 1042, 233, 1042, 1043, 1039, 1048]
#dist_mean_list = [164.87820633501823, 166.37122319638334, 162.7534280259541, 157.23439073723432, 159.72318801009325, 161.58313282742364, 160.88517169663254, 169.15641241074312, 162.06432010869304, 165.41601791596838, 167.81910107347466, 166.9128442906298, 163.64708347326263, 161.98002068387288, 164.73288056768348, 164.84333558963652, 169.1983427179884, 172.6949841672889, 169.69950348192646, 168.28614671769586, 162.62712381386794, 169.10240982461474, 165.73636976463453, 153.91745304902096, 158.69360498774915, 154.30795803724996, 154.1282145725552, 154.75615735185124, 152.43948187135558, 153.62098977952957, 155.2771442073112, 155.9967702392111, 157.38681305299048, 155.36047033300255, 157.63733034845754, 174.33577685649328, 152.85744625175042, 153.8575645524891, 156.89073483044595, 155.85197302058776, 153.99192610150445, 156.04598414968987, 159.33198800563792, 158.00851563344807, 153.50647034970527, 157.45822205613086, 152.09711480029137, 153.64896177287832, 155.8981415851746, 157.17672658104576, 159.66039756382207, 150.96733429588127, 314.83356302583337, 151.61661685264298, 150.20753455550025, 151.98574260806166, 151.2316511489524, 152.34568163278738, 149.71804183379993, 150.91055406961524, 152.23638334800293, 153.39933752078366, 149.8094390920363, 148.70879705119296, 153.423179311236, 150.98373900916772, 152.94481205302287, 153.9627089560145, 155.35813284713407, 167.85043351741825, 153.8500147117735, 153.17373502324992, 154.30306942509117, 153.76323846103674, 153.79235253126578, 150.48596335928542, 150.15082766158173, 151.68770830620005, 151.37165008777868, 150.03484245216515, 149.73928913808123, 153.00710767032172, 150.99716908361415, 146.8202156129734, 151.989842509294, 155.07419092575003, 152.80992682170594, 152.28803687485834, 150.15847785268562, 153.29444461358892, 149.44560961860117, 147.25757001564313, 356.1040543532941, 152.38861605009913, 149.80832416844243, 150.88527391378383, 151.42028137733698, 148.96355307657785, 149.58057013806837, 150.66920263349988, 148.30412026070198, 149.4755915636403, 150.88819632584926, 147.79639016122104, 148.44932772888856, 347.87284711237334, 149.23368321909732, 153.63410363588693, 153.542527848672, 151.79366998743347, 150.5197139107734, 153.27801376094726, 155.23962295127035, 154.2656680699525, 154.29100245904115, 151.01582753819, 151.59695068218167, 147.68565547946753, 147.4816061060028, 146.70750734311628, 147.12166607088588, 144.56017089907243, 144.8817322861792, 144.7674728602956, 146.31047347685703, 146.61082978269948, 147.01346155769545, 144.26967658201454, 145.72227867384308, 147.863771597501, 149.14261845448988, 149.99255301450012, 150.46624761298872, 300.1684165754418, 147.38682417023642, 149.99853665265712, 150.2507767514663, 146.98326926721367, 147.33829510775152, 147.47645182501847, 145.33660283249213, 147.38011211507737, 299.5558189939407, 292.5917090377738, 145.75712455827372, 144.63740067750328, 145.522543164518, 145.67418500480406, 145.45890959140831, 144.70695183626438, 144.59999380290446, 145.59462128208025, 147.0295871916583, 147.53342224006042, 305.6008236830214, 146.83490129325398, 305.8818428122706, 306.29908220880594, 144.21778039323272, 146.25219269990146, 147.14478536940987, 144.5041683982017, 144.01405701460754, 147.7318331001354, 303.8546800177232, 142.72079563973455, 147.21075862869174, 146.60718640865065, 147.31814811885755, 149.5146734389235, 148.03146837722213, 146.71799512975838, 301.44240636036596, 149.31453916399852, 144.1276829633045, 146.48575685359515, 144.0570479592225, 144.04192058654652, 143.97518353737826, 144.26245167073097, 145.02593776536835, 303.54804942491353, 143.42094656814805, 141.26874589741152, 292.32238420457804, 143.97364454458048, 143.83913180517794, 143.6971968498587, 144.64416408163686, 147.9515380778783, 148.01809096221328, 144.08175129814154, 144.0358286959161, 143.73618303904027, 141.77950156887658, 143.5747108394225, 139.28334282693612, 139.0110191658055, 143.4314038067175, 140.59406937206478, 144.05940677121407, 141.34741680454232, 142.83040128025326, 141.63640350434574, 142.00763948652786, 139.4523984188617, 286.23715227197454, 145.86399117366966, 144.2359700318837, 144.27305046158594, 141.44062615432276, 142.8334400334052, 147.49887879343888, 143.7088196905498, 151.03393998087566, 147.13824366667396, 144.8213565836583, 144.1958732071151, 144.65624092990285, 142.87747937548647, 142.18481469703076, 144.123582369996, 261.75120354407017, 143.13894044402298, 269.0233045813845, 144.48032539759242, 143.5312797909307, 145.74418094982553, 144.25934386588938, 143.78983329012172, 144.41042317271706, 144.90469261667877, 145.22409802985592, 144.36699088933267, 143.48446580346004, 143.77496833013817, 139.79254643271295, 142.96511368856338, 142.20997279370565, 139.33394643519225, 139.1040472409323, 140.56288403034998, 136.3813392262479, 141.97438400665055, 139.68339892933977, 139.76666738290896, 142.19983756325797, 142.78864534593066, 140.3909978029965, 140.53939800120665, 141.6173891066876, 141.80621750966282, 140.0041798798573, 138.9608758832639, 137.0009324962115, 139.77452659619757, 139.3833399802082, 143.07197121447302, 140.9032664620869, 144.18245407873795, 142.4557150716599, 140.73522472084386, 143.17029812215796, 138.89596648585783, 137.8940593659735, 138.9394598427005, 138.3695638730312, 137.306013786017, 139.42991981783834, 252.66637927449148, 138.83655344878576, 139.154004358255, 137.87823236043724, 134.15843791272738, 131.9833750623759, 133.3631683146151, 133.58340409444213, 137.7687504645322, 138.43351925741297, 139.26217771135484, 131.2778536049815, 132.0441914692303, 130.29157485967997, 131.3192700052757, 268.088150238873, 275.2395335427837, 130.54400953935325, 131.5623672365513, 132.04739108463153, 132.87360047848966, 129.8179535895597, 131.016553542109, 131.83681864067233, 127.75001218719528, 129.36157821206967, 130.20964677907418, 129.79362220504441, 126.12729290306902, 249.38246408443402, 246.91365550955686, 126.17459303540949, 125.8661669418659, 125.59563130944852, 126.06297837218219, 123.63427679000293, 253.08978844839226, 121.97148815107387, 126.89856266210565, 126.41381555057458, 123.90326826044651, 124.04655238717496, 124.77231900374477, 124.70475466094874, 126.17903429679163, 125.26493044910525, 124.88039553160182, 124.60575223949579, 124.43895295341076, 121.11811263872858, 119.2499478722351, 124.72819040128844, 124.22117663103967, 227.9715454003567, 119.270038076513, 117.33198401998865, 122.6410420118632, 126.09855044946873, 123.72140578647863, 122.69898486437506, 123.03433493307236, 235.26222990473707, 122.8641740419109, 123.20542409253211, 121.57379784021933, 120.95237693156713, 120.29273236196659, 121.03722667364471, 119.4570926817712, 118.87480607984334, 121.91307214653693, 120.01108454550214, 119.63360614285479, 116.12037286149088, 120.44227722539537, 119.79191523905727, 117.74183540179267, 115.93870053083745, 117.0846763229822, 225.35320887725416, 116.51075860804124, 119.31526515699413, 117.62291437528181, 116.1254626355011, 119.73875999114807, 119.12521608564045, 117.3863216445681, 118.38960693478434, 220.35754407809821, 118.76702987865204, 115.90905406469143, 117.6505497220378, 115.99809729358537, 116.39491347658104, 202.64233585613624, 113.75819248641741, 113.72598249774026, 211.22781001939677, 116.79467801034748, 113.96735641275235, 112.56803423272375, 113.72992300169574, 113.86057396399174, 113.49187929624102, 113.45516738589255, 113.30507217803344, 113.19135578824812, 116.70578546369386, 115.18370994184572, 112.96681504515551, 110.66760571083577, 113.45905347865198, 111.63601294980909, 113.93279331589795, 112.56848084302722, 212.34615438665583, 111.85178335811756, 112.78820678389768, 113.00767671429163, 109.48843822423825, 109.39896104625174, 111.64582691780542, 111.64783449166715, 112.44806447133033, 111.81259414966347, 108.65371315175454, 111.27391273346483, 109.08018663878478, 111.77900422132407, 110.5889762276493, 112.5329201793998, 108.80912112974936, 108.14041153059202, 108.9485980678884, 106.82384975241193, 106.77445119653932, 106.71972248124328, 108.30845044225904, 108.7265926729271, 107.3597645585186, 107.2079457543293, 107.4198015496067, 201.8702809082749, 109.04938692499837, 106.37307262489338, 106.10221334965149, 105.93094492926387, 105.59826480498853, 104.27649890470494, 106.87139886178416, 108.13559634089147, 108.31213460809083, 107.47087882905846, 194.783305305095, 105.06513953236174, 105.13351854397702, 104.36170561764001, 104.54928274410958, 103.87828520319366, 102.18853529658747, 104.35767726006046, 103.30053227479009, 105.30493012348455, 105.82967178202257, 104.75516279708653, 106.40469880744011, 104.86821360166807, 109.9451600598094, 106.10119153039156, 103.11734572388794, 105.07787783571963, 107.59591010781988, 108.62012708692058, 107.2925674227883, 108.17296618669303, 104.51350350597428, 106.89364237152758, 109.00788188456819, 107.12313630776269, 106.87950994245854, 108.36543244162566, 107.5319398314718, 106.84808097788253, 105.02079922048166, 102.01154391657681, 102.61587917913866, 98.623345475889, 102.70244957828027, 103.63957832427059, 102.47160734930445, 103.75908811305496, 102.3487519215216, 100.55292254322532, 101.91017149052965, 101.17741519660242, 189.73883201763434, 100.33003334503282, 99.59053525120903, 102.914163829403, 101.30828591690633, 101.65022196396865, 102.5950752707422, 100.12462485727102, 100.65266067110699, 99.55450232946505, 99.71116388845893, 99.72310734444702, 99.73018029184038, 99.57697970100116, 99.533847774237, 99.59871424979482, 180.13219077617634, 99.58139905122152, 99.7440078292204, 96.94536561855855, 99.27404553635198, 97.27846072829422, 96.03229364389607, 95.95659321320657, 98.20464002830437, 95.98253549430119, 96.82167993838425, 96.77623637231662, 98.32668431252088, 97.15040780745478, 96.96661425191036, 171.27762373730786, 97.2842713752496, 96.5202710615691, 96.4396338484326, 94.49036503275413, 94.78454612031707, 94.61201504810468, 96.93080414300591, 93.19449634590934, 94.42315914909945, 92.67003834604238, 93.23940434813458, 93.51701287328419, 93.72548973303915, 93.66510249281055, 90.89991332465073, 93.6869053971292, 94.11769754111802, 173.00884182846852, 93.20900964706688, 93.65495457618206, 92.83071468094755, 93.28103829744742, 92.49533322305193, 91.98917639549619, 91.35460474437238, 93.57995563284005, 91.9263228289429, 90.78039487614885, 93.83228235114392, 94.00407137182471, 91.73802395167912, 92.25397626201539, 91.99535985244215, 93.16495759742833, 92.61044015892773, 93.0387518341909, 93.67313479114976, 161.55715430041838, 159.41674937815387, 95.21505873911555, 161.48208185172967, 93.45922194116203, 94.2255395765057, 94.04960043661198, 94.90099415931468, 95.13368770849631, 96.01427943099013, 94.6034895347186, 93.87182242948738, 94.1455084617037, 94.60940002366515, 93.30681640047503, 92.13589670961875, 95.06762917975742, 94.02725703922832, 94.85905529122596, 167.14352853396858, 93.85060457406645, 93.11600057582811, 91.20597465690221, 94.53440086987379, 93.96642352116096, 94.99574555846189, 92.67751226202739, 149.61727288018255, 160.41542131199324, 91.53142194387287, 92.50023179228825, 92.93821541348251, 92.21221590822583, 90.73307829198477, 91.09086962333888, 91.57520591742511, 91.24268357324982, 89.83646755533432, 92.4876533486139, 154.1309067067526, 91.71714289053548, 94.22298908523176, 90.78494268174417, 88.99877863232798, 89.96466831684536, 88.50018121325189, 88.08059549548337, 90.25650172852592, 90.31593350165667, 90.83310304850309, 88.28877110559156, 90.52198100878788, 91.51089360891851, 90.55007546744528, 89.19275656509319, 89.04335696512507, 88.53626019708155, 89.69590411394667, 88.76429345869619, 88.69369820130599, 89.79650063636129, 87.93196064964788, 87.40563814061302, 87.92979833834289, 88.34881420855505, 88.58630241890067, 86.34186780510669, 86.50925741000312, 85.6375690150117, 87.87160983451585, 85.34262263466537, 85.80363963369183, 85.73398658766958, 84.65074565764404, 85.17510021698567, 83.92021392483952, 84.55124910027709, 85.33067233619262, 84.50709488037344, 83.7835808867764, 84.37465670102638, 83.44366060564312, 82.80204512128007, 82.11293817747045, 82.60348438557256, 83.17487297846046, 83.51257112459237, 83.53700979146082, 81.62870668752977, 81.12950710768632, 81.18089682948113, 82.01480118005485, 80.62030504558426, 80.30007227028624, 79.73479827812386, 80.63979949719553, 80.59033837168369, 81.64674719959953, 81.24084947232832, 79.73829007364954, 80.18973590089666, 142.94608163022866, 79.63215855385944, 80.25407464070526, 79.26147134607335, 81.16222001788356, 81.04093908033103, 81.55357402033123, 82.85722940602983, 80.5657128582074, 80.80148834200229, 79.8962669129838, 80.47146046401005, 80.35642117840536, 79.28343917034223, 78.67929338276936, 81.72348609528055, 81.28788058037688, 79.59914919401078, 81.84857575552154, 77.56348682594654, 79.7641100838439, 80.04395080279589, 79.90708898715336, 79.21671924463624, 79.79534484389792, 79.3244072401759, 79.15027501741713, 78.80457012643676, 79.2032756197968, 79.25538311486821, 80.53660290136706, 134.82749371276958, 77.99224006565152, 77.82848933495941, 79.20310034552564, 78.21036857410378, 78.36499864178607, 79.28207237341937, 78.09588321214764, 78.56043203794404, 79.48166399315299, 78.44349148726184, 78.80741852970364, 78.21896946048652, 78.40979750905362, 79.14354797309085, 78.02421613671315, 77.45108027302776, 76.62302032582944, 76.66627081592442, 128.31405681636653, 76.30927800210098, 75.92306108966896, 76.13579407226007, 131.80236472488158, 75.31687451456041, 76.02892458482005, 77.05712377733603, 77.10127746186147, 77.74983608715127, 77.75002771900576, 125.56103163997714, 123.21242577011027, 76.18677189009927, 76.27758946212658, 75.42514413100771, 76.3417258950037, 76.89362795257095, 75.85439452547433, 76.0463409784357, 75.35350989448177, 75.86023801832721, 76.1325091486097, 76.05336209702546, 76.07365351773397, 76.33398394998103, 77.23652919827202, 74.85311476327595, 74.80824905901748, 123.31414127543398, 76.23888236751561, 74.75501123146643, 73.70084581193694, 74.79532255577489, 75.02790475409948, 73.8636863060124, 72.98727152575991, 72.63532843235689, 72.50626421022834, 73.02880700213623, 73.2086903447998, 72.40843133755104, 73.07722942947206, 72.01882559751611, 73.8938802291781, 71.60449163554799, 71.78119124725966, 128.04396915511617, 71.2707270931399, 71.06999825111488, 125.33371905496345, 125.52391849167694, 70.70793944243968, 70.70083797699654, 70.69359529402666, 71.58963934270933, 72.3846188166872, 71.54515576747795, 71.7500352674407, 72.08820777132213, 71.93939511753662, 72.45439708174348, 71.20909924716167, 71.58082263850854, 71.2116063971975, 71.18694900659227, 70.59905631118599, 70.32997065963427, 69.94308177648061, 69.9930544593949, 70.90315070077106, 70.72988156453201, 70.86919848666905, 122.235210225644, 70.06166567280646, 69.84431045999838, 69.52956197869663, 68.96300714507396, 69.76508278114558, 69.89567827077484, 70.09008481085172, 69.48191604819172, 68.98761037134857, 69.97143157574018, 68.78542484285234, 68.27774304408044, 68.26880854445736, 68.33596985737803, 68.32361770307267, 68.43957863723504, 68.19170425875201, 68.42793232021847, 117.05032987041307, 69.09191811086025, 67.85094617044787, 67.726040408299, 116.73261594762515, 67.78904708913299, 68.54205051916237, 66.73013900455295, 68.34934226441963, 68.52309914440255, 67.84515479331445, 67.91715749401533, 67.71146436415397, 66.89237183693862, 66.91769204483924, 67.08797166847354, 66.90743430315405, 66.22649885584487, 66.42280880993503, 67.16003169614818, 66.55153564770862, 66.00032932635588, 66.35020846634261, 66.57514796595599, 66.28636315384658, 66.0600558550193, 65.32979614120231, 65.92298039509878, 114.96754827306488, 66.24821235577812, 65.46077270105548, 65.66705419532988, 65.77217477925416, 65.95463211456517, 65.9277076603265, 66.07727285799088, 66.02539753396226, 65.51967969658966, 66.56824261985872, 67.13716636319805, 108.96235586188362, 66.39200571807073, 65.80253994224265, 66.85286451486448, 66.02310412244277, 65.14054953056994, 65.34313400906542, 65.93671467409838, 111.81600072402809, 65.32684033030353, 65.62532918322394, 66.01221706417454, 64.40301972737959, 65.71486849944512, 109.81801420717368, 65.28225383522755, 64.45000672026616, 64.23042620062515, 64.00287112992085, 63.84653866892402, 63.260045038741275, 63.026992919744316, 63.641408115815565, 63.939693778988925, 64.53269859590488, 63.204801313919035, 63.685261420854594, 64.57116421739096, 63.57329282868996, 63.37039560568118, 62.79894482731792, 62.8256024812331, 62.05061434499686, 63.12852142373774, 62.745236272440124, 62.18141586857665, 61.9819754318825, 61.49533498944456, 61.377268240396866, 61.946314903389755, 61.424220173359906, 61.358914086818665, 61.913295960362696, 61.467008230501385, 61.05518820787817, 60.52444154404334, 61.00363212580546, 60.35455724974736, 60.239508096464085, 60.42405009757426, 60.5474310522055, 60.0870329912633, 60.87031714112283, 61.20038542469118, 60.858054992068105, 60.52949777999579, 60.58474601893863, 60.53566747003035, 60.27591050557504, 59.46529817992256, 59.70863525854995, 60.271513008901124, 60.26295474092981, 59.82483544202146, 59.102231566312945, 59.13566943646211, 59.35145628306707, 59.43270690876002, 59.67682675428925, 59.28753098092893, 59.067568648120265, 58.83035925233013, 59.139769971807524, 59.1887195689891, 58.62824039197862, 58.70585648794244, 58.505054697999114, 59.117223666272814, 59.62197925841375, 59.73379995421303, 59.60987949572953, 59.002916757639134, 59.549117276355105, 60.43238194361372, 59.95560977265251, 59.242823534165076, 59.30112850112621, 58.45188552253148, 58.43277430499265, 58.494290243831074, 58.51762018851778, 58.34587239227471, 58.669248893893055, 58.69472806654105, 58.41871013376852, 58.50454611228386, 59.07604332247213, 59.031994661867785, 58.33628915450871, 57.805397516276805, 58.08385289555578, 57.83916407600997, 57.525300768156754, 57.53645094052783, 57.10801511547397, 57.499275867921234, 57.80194793555507, 57.41432807245898, 57.74231942965507, 57.7199640276281, 57.734470156726644, 57.548355825611864, 56.79150166047327, 88.1087850880551, 56.91303126477287, 57.36451247015271, 57.29640653878279, 58.073917342778294, 58.20059574156754, 57.66424510802517, 58.425921366065765, 57.90356167006579, 57.28263364933667, 57.05731508759742, 57.30120251075844, 56.58649474825131, 57.014787195634575, 56.92073032106467, 56.91751239315886, 56.97549981069963, 57.27609085706265, 57.51668208974177, 57.054288175437925, 57.262465299639864, 57.45843638621764, 56.674804670611564, 56.97191311377665, 58.04557618308887, 57.56927367714523, 57.35312371933538, 57.87040955122641, 58.08486580938196, 57.56074142697586, 57.33577371311478, 57.2153746256562, 57.46555370934143, 56.66217881390869, 88.40782454253475, 57.241986981954135, 57.20668685482726, 57.00579283698105, 56.62683060637264, 56.486079731056996, 56.36827800702781, 56.00932198398828, 56.403320588903, 56.29399343981074, 55.795210895851746, 56.349685522965395, 55.70239909032117, 56.642950696912784, 56.28632316407241, 88.58192061868925, 56.40069608080282, 63.318589864961574, 55.56987844415315, 55.61001662131947, 55.47220827241632, 56.010343753292936, 55.47342811910961, 54.82985857479927, 86.90174172041635, 54.70169937488752, 55.31096551908552, 54.734621520764236, 55.123856006183814, 55.56570029845395, 55.82753432766208, 55.06338001579042, 55.19626146970902, 55.10393470378402, 54.98056319978678, 54.87462797427202, 55.49444182408573, 54.652530852868466, 54.913484400584714, 53.98638348686944, 88.86436356396455, 54.762085853403555, 54.655229283232515, 54.32936961695532, 54.470743232279986, 54.00216853893715, 54.42114613273037, 54.36585499345249, 54.62862293008988, 54.35373428057023, 54.66933890209706, 53.84641032947187, 54.25615311370911, 54.787649888380464, 54.59802148803685, 88.1807139399917, 54.473423474494794, 54.182399831952175, 54.431994300130775, 54.00017779899781, 53.85616294388661, 54.04844048167349, 54.402724273297956, 53.938298378491574, 54.6437648414474, 54.254990221937454, 54.15790242020918, 54.44809679875684, 53.97034485264919, 53.51369278992356, 53.99010170969073, 87.90579371483025, 54.14011854604569, 87.46802099512033, 88.13631365519142, 87.55258485583393, 54.20388456935777, 53.98132271883768, 53.929631665262995, 53.84929854775686, 53.25184339063883, 53.571219539191546, 53.193370804114714, 53.12658473754164, 53.246181836313006, 53.206680330592704, 53.18048785922498, 53.183800144913036, 53.88366066079703, 53.10935613293286, 53.400808443055325, 53.651551500274586, 52.66098866166667, 53.54397087684483, 52.97092290235513, 54.3105578034229, 85.21217623668245, 53.33340414796711, 53.13683018785601, 53.421827753629344, 53.31263855632784, 53.59611305915867, 53.608414137568495, 53.298358236617894, 53.19861537478911, 54.0180219042493, 52.74872792818561, 53.240619207044844, 83.23021704241994, 53.48978189990096, 52.82111670089114, 53.28325043534872, 53.34630155962016, 52.91999094662986, 53.01346585855729, 53.573226035922396, 52.85192812460912, 53.288057599406216, 53.00598871882825, 52.7851062565376, 52.84431325082083, 52.932818347796115, 52.91265536745076, 52.901005756063725, 82.55253887146016, 52.50342921620393, 52.22377896600525, 52.612252166842346, 52.437699414048765, 52.17641873601254, 51.97832205893347, 51.827570713228766, 51.82278978044404, 51.57908001704967, 51.17137725825619, 51.262949945349845, 51.53876536372131, 80.56886795293747, 51.72940257953116, 51.38686284264915, 51.75508697542558, 52.09181816642047]
#dist_stdv_list = [126.82147647041569, 146.3205981459833, 130.29827723548712, 124.67676245969365, 126.27471913236461, 127.55600810925075, 132.03339771433807, 146.52041538329675, 127.64731848249713, 132.71452226957007, 135.30724131447914, 140.38591887704996, 137.36908518677424, 137.87492838432934, 141.3148601762421, 138.87867852781915, 148.55776744614892, 152.8844670332952, 151.7247755808078, 149.73981695901995, 139.04676124302384, 155.25980585433382, 138.88228354973882, 116.24030889149041, 123.37311309144528, 113.08185028009102, 111.52319974797076, 119.03251767184254, 109.96439064349268, 113.3698104232812, 119.28675903438018, 125.06768779649948, 124.51595142107769, 123.2895799843669, 125.3301799918169, 116.81751966559699, 121.44984811799604, 118.42975943365735, 127.9388784970508, 125.28872858365096, 124.27509024643311, 125.57190728407018, 133.70139463288754, 134.13232043997482, 119.11442449385306, 124.74914149325011, 112.12815028989777, 119.59116237793297, 122.80816398124057, 125.62333135581336, 125.71405505245137, 108.54193762642807, 230.30256607672897, 111.20200420304786, 108.14608166573285, 110.12443982213935, 112.0631026385822, 112.94013680143176, 106.9471146878355, 106.5471002117325, 111.8733334156337, 114.86354555064733, 107.74359060628005, 107.0274490467705, 113.62363137371413, 108.72083054601214, 112.23272748182775, 112.06768538079096, 110.70385459410423, 126.85167337906945, 112.9903205038056, 112.95011930055877, 113.15728140971115, 112.36679746378078, 112.96021043571388, 107.0783567357081, 106.3744365133151, 110.92937242644332, 108.81896275109591, 110.52874513919659, 104.25647358613084, 109.54674173474667, 105.13358085462602, 100.86875753825686, 108.58092011766948, 115.86254492971747, 111.46558126658498, 110.03169593885383, 102.20645018345863, 110.10887671766247, 100.65580896746113, 97.50215809123912, 239.02064345795836, 108.67048512247847, 104.91272522821838, 108.42583049720282, 109.1393436298425, 104.52920470490953, 107.76106750123114, 109.80009326212135, 111.05622806708678, 110.93270880824018, 108.33440676860182, 108.6140614774207, 104.511428712321, 236.04824712190845, 100.44025815664635, 110.20820423227234, 111.2458305315436, 104.09973326685936, 102.20694673538894, 106.26997743338514, 114.19026374822421, 115.657212073483, 114.30562677734352, 106.87815401226048, 107.05950347900591, 100.83594356375868, 100.27054470144544, 100.79622941511127, 100.66006815947172, 99.33259034399, 97.94204833178007, 98.45703407146463, 101.50588154165696, 100.94269709742042, 99.86488035022147, 99.71305743477551, 99.36634004762548, 107.9590289033688, 109.91377027872089, 112.57947445757335, 108.63700193807402, 238.06791341792012, 106.21263707505459, 107.54012699440902, 106.23654809433302, 102.48569537943109, 101.32196970637794, 101.82405439848392, 100.23851077420619, 100.5244383852079, 240.2668137514254, 238.1427357383497, 100.3131376878729, 94.36303607361089, 96.0264925526541, 99.74330458952588, 99.45266382581093, 96.41116773470137, 95.77436689455548, 96.23765350490926, 98.7995207583879, 101.76946373379732, 243.9985762923621, 101.32637107387633, 244.60406337101156, 244.75713913861313, 96.6782221541253, 97.70135833802149, 97.42015535349306, 95.86079254808455, 96.73792834831193, 103.92922285044789, 235.81831534620818, 92.22168411355305, 102.45917798342782, 95.69064122520777, 96.33939005328115, 101.74366981324098, 102.17264990878138, 98.3483038013924, 237.10576565756065, 106.83041991212401, 88.09805493289768, 94.63793300551878, 86.74602712208497, 87.0989135203547, 85.59072949873241, 87.6026779053917, 86.94112610987911, 252.8143542342551, 87.41698175441043, 86.26442050794499, 233.8003734387864, 93.29408754496993, 94.46882619199303, 90.31972607267495, 89.094874770488, 97.01837765296077, 98.24062138851244, 83.73193682254909, 86.53041834982311, 87.50403756065543, 82.78454358653526, 90.44386295325518, 78.9520471318361, 78.46489340468564, 87.85413482343239, 85.01257106504453, 92.65836495296755, 85.72685191756207, 90.40667698851787, 89.73256463807944, 90.53980639899414, 84.54988924844398, 243.30549646394425, 99.67246920739044, 97.20200085836909, 94.94524307785767, 87.88135887460979, 90.18339913414636, 104.17432030254828, 96.3370885362643, 116.35287035202018, 107.12295065252817, 103.72972353184443, 101.96931457749282, 105.95318843396461, 97.58352221804046, 96.37298461168136, 107.18420350446677, 220.31322067852167, 98.68451487430687, 229.314827362413, 100.35498127886456, 99.56974831289072, 107.30320022319329, 101.18639946525957, 100.82598989345497, 101.66050727427768, 102.20405264696316, 101.72666953724855, 102.71957888334933, 100.99790735840246, 100.44072217757487, 85.08667303679044, 97.71990600424745, 96.86193317091349, 85.41978992587498, 85.71313210862385, 97.74772679554522, 80.70390778733237, 93.71718360519013, 92.32401624674716, 92.33136070819279, 96.67154395313588, 95.93418854644523, 94.61375102072, 93.57596127528518, 104.78484972446113, 105.75192971018998, 103.0674562304623, 102.08925047291622, 100.13331823634944, 115.32421762199507, 102.47208657999626, 109.82517730329414, 104.36697946226094, 117.40169370055257, 103.57766689908617, 99.22398416722966, 105.48501025764968, 92.46405708582809, 92.30155089123616, 92.57133964252398, 92.56684913734121, 89.46647548879871, 97.6750088565338, 236.83638223960133, 102.00109255656378, 101.10062503096201, 96.21993432418435, 84.27745029921336, 84.38033268927859, 83.57789727591704, 84.40805565551433, 98.56758936232403, 98.13979417226251, 104.6834876406953, 90.86859312332616, 94.33389611692364, 88.68718546052108, 99.90449637886626, 231.11676462287997, 237.94709059323714, 91.70112672891298, 94.50714402138881, 92.16838471161516, 93.80470726982662, 87.84540071165522, 90.43396039979821, 91.88370279752493, 87.95376689768055, 91.14374643745788, 95.0536668250552, 97.6499619327743, 86.55301207135795, 231.0315835229222, 229.28157973244586, 93.0178171502771, 94.5744944148119, 94.59579403494725, 94.9547707381028, 91.1863145673622, 224.9746918843224, 92.50341263491966, 105.5388141540652, 98.41836602797139, 93.00927619921158, 92.33117006918351, 96.49343009577143, 99.27443885721539, 105.59639299095694, 103.91179129020153, 103.44252069359291, 102.26928758719069, 102.3795029410579, 88.44508045574852, 83.80070801575012, 98.85100864553756, 93.90002275720569, 200.76246924676246, 86.56368363936599, 86.33720638577167, 88.44687613203877, 113.6417083706455, 102.42264013123055, 98.17993447611755, 99.01899635341945, 221.0211068954009, 105.18538179188893, 99.51830416214422, 98.45608093656381, 95.55695342087118, 95.77057104646056, 97.66466121460417, 96.59787461728706, 100.09300176604874, 101.33115688662036, 103.04442014630665, 98.85573006193465, 89.95379744804453, 101.31971046254202, 98.84762544966172, 93.59156380447652, 86.1857711473176, 85.809719495628, 209.77455979947402, 84.67100311495406, 100.20672905489393, 93.73207067985823, 90.25868852033143, 110.20710890421395, 107.48908868563777, 99.72808640416828, 106.05955719513057, 206.17538747533922, 112.60462575490382, 102.6886435793395, 103.38702628998983, 101.71718158338652, 102.46697821173896, 194.46901631006435, 93.02762668765845, 96.2139327888685, 202.19269509100107, 104.32407396779563, 94.42841580915243, 85.89588978172804, 92.75607631101181, 101.48769490238755, 99.24225322318995, 101.79592679601053, 97.17097873140598, 94.15226445467633, 103.78003216411854, 101.26939207084745, 93.99667512280237, 83.67352414875494, 93.57574216351352, 86.51598415050222, 91.93977307693228, 86.8856712032523, 205.38469174772695, 90.86570856309335, 91.00345757468789, 95.50131266086713, 80.35656319425823, 82.33376480322032, 89.42589710372528, 90.05544832639623, 91.50013129626437, 91.18010253037372, 82.50588068958055, 88.61808540632094, 80.96433390858876, 96.55906149037618, 90.83247231730509, 91.05625045286881, 77.60351768397484, 76.76563120568329, 76.30923274262874, 72.73204253965037, 75.83345613398971, 75.20181446660973, 80.16088371948224, 78.34389129662732, 80.51091054803197, 79.3141601743196, 78.29505362908765, 192.11640125832338, 86.40926444968484, 75.70056888573693, 70.83384132049865, 75.21030990130794, 71.79240425725972, 64.29239742449077, 77.03775801258547, 77.99381828140498, 80.60778051169719, 77.79677610501312, 185.5405168632372, 69.12098818712494, 70.40796344508882, 70.63125076993816, 70.82636526539689, 68.51171928676017, 67.73007110416408, 74.17085656376965, 71.67048512497317, 76.56214112201033, 79.71127432751773, 76.52484517306823, 80.43914009909338, 74.49917438803104, 95.07118308172915, 75.70441955924588, 63.957159903958186, 74.14278849745162, 80.42045170672743, 89.1751391686441, 78.12022035856036, 84.55817661463435, 71.98332181260423, 80.9714296190186, 89.71291152243562, 88.21392986501344, 88.82217708558866, 89.36296607242085, 87.277222134209, 87.43293428277114, 80.08265756172742, 64.23963783733937, 66.70276862390718, 60.25979647989866, 68.25423298354279, 70.69184399797585, 67.96760627499653, 76.544321836593, 67.05364303449001, 64.20877776132615, 64.75934807416228, 66.30728655188014, 189.06642975822672, 61.65335982322907, 61.06895237906654, 72.4212519520598, 69.12861597032341, 70.19743493447207, 70.79376489555592, 64.93948109584068, 64.08651007506407, 63.02598742119864, 63.519806355653635, 62.56978583268232, 62.3036785883039, 61.74938924973831, 63.3124556115271, 59.801661387574086, 176.73561120165635, 62.039388347636596, 62.65510521233321, 58.07379924756857, 61.67665840471651, 57.993415143513, 58.22142647079329, 56.81229198892741, 61.88215407522523, 63.24697155186979, 60.89473031695377, 63.69077936091344, 65.78967269033228, 64.73308754611276, 61.60067052319095, 174.99805547088448, 62.207185060746944, 59.346153193849524, 56.48163770825882, 54.88940458311744, 54.481842889450434, 55.18362787543255, 69.07673626405052, 51.2727395788802, 55.12112095597868, 50.639014793878914, 55.120685012016324, 54.02764618408894, 55.2462844366938, 54.12064957010805, 50.43401828639051, 62.35888764104199, 65.09785773624361, 165.52433545357167, 62.40309371561365, 63.91380490228289, 62.4331960521117, 63.027684508864766, 56.98226466112349, 54.39947098551804, 54.71078996712122, 60.94047780608015, 58.491501962011036, 53.86703797811378, 64.18727599031918, 61.8376668090612, 56.72618112641133, 57.127075584392685, 57.31525792824574, 60.27728283119344, 59.74939961535578, 62.82633208237142, 61.9284847388539, 160.1290213216783, 165.09719283952984, 65.7678510407527, 167.4316004561142, 59.8328024957527, 65.5569307129592, 61.443778542947555, 66.92258366758551, 67.84662955909704, 69.91070595154234, 66.76391273376416, 65.88934280769693, 62.78011799575901, 63.96165256541167, 60.56284807224084, 52.90666421069227, 65.45235634363982, 58.369951056945325, 64.38657167595785, 181.81954965511088, 68.30795848197424, 61.408186562666785, 55.94239450374932, 69.38789403207014, 68.10291943750664, 73.8765913416706, 60.05719442258423, 160.71562317323713, 176.973355259892, 58.988347308599344, 59.09337423420362, 65.5656535326516, 58.96010256721187, 58.34899043764249, 58.11582605871157, 60.727229038890144, 56.6907294800849, 54.480545697446615, 65.52530765708147, 154.84333085955907, 63.879889492386454, 76.36146362366328, 63.196582089056704, 56.16755368486678, 59.61985160422886, 56.73589989293056, 55.802772995115056, 60.6072934690744, 58.18133627367179, 63.313570065785804, 56.45730066842799, 69.8144657345425, 65.09961259777648, 63.169141045929386, 59.80282904536715, 58.451129236203435, 57.03328505957764, 70.99971706451699, 58.42193235501145, 60.72026811140501, 69.89855655679402, 56.39725880308498, 64.67399745397087, 66.4621005948253, 69.34372610932353, 66.95738122421024, 53.31410633766139, 55.7524228335316, 49.94349902748025, 63.88380509734813, 49.244450344917944, 52.1386225873452, 52.03298021533849, 48.88046260895989, 57.397979922477155, 53.6763541535407, 56.68094430939567, 59.21281334831112, 49.71844835205873, 48.33585340825001, 51.003252634320724, 51.07057691288093, 49.09960665322977, 46.789997270661495, 46.55287556990404, 50.78800407441833, 51.422534158815246, 54.33812487505789, 49.66464295992478, 46.9837050153831, 50.04355591547362, 51.78588120104875, 44.226872274949756, 43.94195302628501, 45.63751510748598, 45.20992336575331, 47.20530540615572, 51.21084469468045, 50.475284395826606, 44.08250663091001, 47.55491528808096, 142.5942226604532, 48.71624266265182, 49.009591300283006, 46.00489423231448, 54.047645964146845, 58.43813999036433, 55.63690514054906, 69.99289479244334, 61.407661191234745, 58.298242891603955, 55.140085982702026, 54.91381981833206, 55.59153717821201, 47.74830268892926, 47.61789101231903, 65.82983583712942, 66.76597157564498, 50.96627618563485, 63.142519941540094, 47.96044013007748, 51.24318838798191, 52.635838495531516, 52.283231795799885, 47.181749197934835, 49.1042642110894, 51.75217314285903, 50.840049913230075, 51.01440430699351, 54.36828897954644, 58.32284429526308, 61.05027087503912, 139.5435903622322, 44.00352806170261, 43.87648725370882, 56.10978841327958, 49.11815952298147, 50.730362258529254, 52.43845666330572, 49.09396973766366, 50.82991595751962, 58.1419078907357, 50.16076950060563, 51.77150255042406, 55.90784715540494, 53.87066960684194, 57.42745187125578, 49.85915247582917, 47.311113292591344, 43.84889696123673, 45.00753186916609, 135.74339060112234, 43.297600792258784, 40.06916097540292, 43.03645570041279, 140.8250995092847, 40.890039194434586, 44.12018870031279, 51.43024609643945, 49.23478052825994, 58.7088361815221, 56.82549923438016, 133.98434700896266, 132.3737006294489, 51.450862854305534, 47.01555571742878, 43.794089124650064, 51.18331746704277, 49.813657339436816, 47.9572057869482, 44.62447608355686, 42.87513133402946, 42.84449504741799, 49.66848052597374, 46.21246645322994, 46.727627458364296, 49.41736287529407, 56.35676826685598, 46.57315828219251, 45.86400126334935, 135.93251498277, 56.6085627121629, 51.3822758811925, 40.575315105079895, 44.48291516360681, 51.03045512662112, 44.033551480867246, 37.157393190445795, 36.516621157462076, 37.685343480606996, 39.08977285401887, 39.412867457871364, 39.96456170651791, 41.59449220090541, 41.88149739785458, 46.434635920561426, 38.02098845107767, 39.775193617708794, 137.715792937392, 38.287605474483186, 38.61606641002758, 137.28785351224565, 137.03097134992942, 35.93774608498176, 36.042540589353, 37.38855626356215, 39.68850555556918, 50.0721801318957, 47.3204522447156, 45.481945185680615, 53.45310473634776, 53.36967732122877, 52.87757898115325, 49.26604677822248, 49.94846462638882, 47.807782629142295, 49.95295379338443, 46.368961821199754, 40.893926506199506, 43.240281868074995, 42.4559804909313, 50.15199527636548, 46.44118967974236, 48.94538501862872, 139.392210839656, 47.56533815960936, 43.948849441497174, 44.68428449341491, 41.66196361006153, 44.48260620601541, 49.830516722329236, 50.56597925985611, 46.93055993266242, 42.700254917154346, 50.913211562201816, 41.82199624375317, 40.944204923290144, 37.67880690472653, 39.176186536382914, 39.79974524508929, 43.63353713622393, 40.09731655735605, 41.30574490237456, 132.58049352749933, 46.05345314598405, 38.75861535615885, 39.53825709546563, 133.13941941705139, 41.24289866849036, 43.01448968150953, 33.6264606163451, 45.17322356552155, 44.33241989158371, 45.288625787133135, 42.72552485597928, 42.561362730873554, 41.864685223539986, 41.606118644382384, 42.87407700484606, 41.73194408265234, 40.72584914178776, 37.10483705260011, 45.67500065063445, 37.10757073233098, 34.89324687698628, 38.76900001817009, 40.85287164820377, 43.25223833095771, 37.55012723856472, 32.71727512996036, 38.494353449090795, 133.77438002080814, 40.62066598653442, 36.136667351371344, 37.169494344449014, 38.17808177324724, 40.19949656270919, 41.236655576795194, 44.65834810258616, 45.256538440490985, 44.633975689970434, 49.41019409926331, 54.21432395140001, 127.81121738032779, 49.14391764123238, 47.763843394987475, 55.45088177799373, 48.37918264699895, 42.35064517515664, 43.657654840343, 51.26145097679701, 132.51714892286935, 48.4348563060568, 53.07856658215455, 56.03889210488669, 41.47367728333792, 54.943792310901344, 130.3943953494362, 49.44218428346152, 45.30052196101037, 46.16432740898657, 44.11774426963433, 46.66664881023852, 40.66137560206596, 41.901614996276116, 49.09930997749191, 52.336770620739465, 52.66068542877302, 44.32318972098745, 49.19009252199447, 57.05673708602246, 47.224410233291714, 48.28553805060951, 44.08583131604099, 42.26860013762566, 38.81142844358665, 53.07433916260318, 47.91831094032144, 45.4041724211264, 45.00469088246657, 41.641016494507134, 39.16820977954377, 41.08996015307956, 38.414483544953576, 42.83589362784893, 44.869371689772805, 44.67638679406251, 37.39290671695145, 35.698339871828104, 38.22528502011072, 35.116637531464995, 34.10132553495844, 37.28566667703627, 36.396784057802684, 34.47908593279971, 41.662772483303506, 45.88724531615119, 41.08131719134357, 38.68004247073256, 40.873603265746766, 40.08856158374513, 41.73417636194963, 33.59547961071678, 33.6936774956838, 41.6603093900475, 38.72402923881151, 36.493042206104974, 32.71567789015539, 31.503377778005376, 34.500872206250804, 35.4337999723862, 37.16602050341709, 39.92816995230939, 34.240056147726385, 33.1520127306964, 36.05425202550409, 41.48946103380933, 32.84702636310527, 36.40635780797463, 33.60641445170565, 35.969845927672466, 42.30141359366323, 39.02944581914527, 40.40366134804819, 36.238424373562935, 40.91666876343216, 45.815699052436855, 43.2586440926967, 38.5573197329437, 39.45722500670192, 35.95511552940594, 33.07426387416103, 33.63184424372599, 32.71350105888549, 33.67427222166261, 34.832107749922045, 34.86094729081133, 33.37204390856965, 34.640663136274625, 40.18942387429935, 40.046205940705526, 33.68395858026522, 32.14126253684034, 34.89346757772817, 35.35994751965041, 33.87222428640335, 35.19734396327651, 34.01536537768529, 35.81668671886764, 37.745335560639134, 37.29505532565999, 41.54139373620072, 38.64595786630324, 41.343850974687264, 40.46978358285805, 30.231279576017695, 108.16704844531439, 31.829775168360502, 35.54265803794339, 38.192868787772966, 40.73843294994601, 40.066888943882155, 38.15468088952166, 46.37187634174547, 39.53878987112875, 35.451310364719774, 32.80352637815036, 35.08722725980827, 29.8930057511746, 34.31994696940626, 34.50062490575547, 34.10812562318762, 34.26593633941187, 41.039255283342925, 40.656376624455696, 36.159877631712966, 36.054412423495016, 38.567495800037335, 31.358333615176274, 34.874289830433185, 45.917776863793414, 42.482913560421736, 40.93506648558706, 44.124097735375415, 49.30012306664843, 46.71320224250288, 44.25434397689967, 44.459479293570695, 44.666681192911, 38.30750314876515, 106.65499968956048, 42.70509513868423, 43.6051419586971, 40.54114783425773, 35.02907453894185, 35.188482451213574, 36.34822197998955, 33.881058609892776, 35.58174268644074, 38.55829045341745, 35.57458492794744, 39.86984060447065, 32.97293765549692, 41.510501265365946, 38.06339288089605, 108.43592556736371, 40.68854233229967, 51.52179576755682, 33.406175825987305, 34.69336640187869, 34.53846027279293, 39.573433178762315, 34.5204786854096, 28.909601180574498, 106.67504123690787, 29.847727900439956, 33.36464166688827, 29.651756305235782, 34.67635438863713, 39.393587153207804, 40.36447829043366, 33.84663256711363, 35.849369108272484, 32.912663895529995, 33.16716079670013, 31.094930687504334, 38.11933982274055, 30.357749889474352, 35.09894508443509, 29.871360401961052, 110.9919533295766, 39.13009451281114, 34.86473755122369, 30.619872395578703, 32.12331852191689, 29.545427944881833, 32.749731263983755, 33.2760874800846, 34.316273181146556, 33.64549264754936, 35.70888360466879, 29.181775085861126, 31.780394452224613, 37.62886724707055, 37.15799796923753, 110.52912576504677, 37.150670165705435, 33.936626578646326, 35.22145735212716, 33.717364180670316, 29.722524731580766, 34.89904509042876, 37.75557978134194, 33.02104981487213, 40.549428962445475, 35.45790555262487, 35.13469569165827, 38.59136692795379, 35.96785422169598, 29.833033311863264, 37.826421813932804, 109.84566192425802, 36.06397871054387, 109.73761210603479, 110.07994380491428, 109.91292899218728, 41.488581104497726, 36.96079068344388, 36.98130989522991, 39.701667582661415, 36.160032242424826, 33.41167964813446, 32.16065114530324, 35.424041583390284, 36.499362207409064, 36.19777751081053, 34.705372740576955, 33.44679065352311, 38.835037670919455, 32.828208808995484, 35.8012969676153, 38.767618840262486, 30.422777328734334, 42.065780000853565, 33.038596557686624, 46.81675524885472, 104.11713268808012, 38.001880575718445, 37.28552412187647, 38.08401751094144, 39.831080945016886, 40.60055651429881, 40.77747030470589, 37.73308899652566, 37.84146285886218, 43.00572619116433, 34.618410413476155, 39.665890638181, 100.6167772378704, 39.63872410402594, 35.10289233661174, 42.37172008654979, 42.12329779425492, 41.472970710587276, 41.256670964386984, 46.18734781477241, 38.83958481215689, 42.65501925041582, 38.732410550065175, 40.04577175277492, 41.06233027666369, 42.277521526717315, 43.05397221801554, 42.23362302243161, 100.73344356044234, 37.79822108545112, 35.70039085821003, 39.84873372096396, 38.74510705594992, 39.65251180999144, 35.40204039061217, 34.49604286702401, 34.17747180938428, 32.860947414508445, 30.28878208390979, 30.642517836960103, 33.56085663858684, 98.82626854060723, 34.065710233675155, 34.65553536173628, 34.405729411934374, 40.193840844129895]
#blank_frames = [52, 92, 105, 133, 142, 143, 154, 156, 157, 164, 172, 181, 184, 206, 222, 224, 269, 284, 285, 298, 299, 305, 322, 330, 348, 357, 363, 366, 384, 411]

# Plot the thing:
cell_count, means_overall, stdev_overall = CalculateTriangleEdgesOverall()
for index, (cells, means, stdev) in enumerate(zip(cell_count, means_overall, stdev_overall)):
    if len(means) >= 2:
        plt.errorbar(x=cells, y=np.mean(means), yerr=np.mean(stdev), color="dodgerblue", alpha=0.3, zorder=0)
        plt.plot(cells, np.mean(means), '.', color="orange", zorder=1)
plt.title("Delaunay triangulation of GFP & RFP cells;\nEvolution of triangle edges sizes in all movies available")
plt.ylabel("Mean Triangle Edge Size [pixels]")
plt.xlabel("Cell Count per FOV")
plt.savefig("/Volumes/lowegrp/Data/Kristina/Triangle_Edges_Cell_Count_All_Movies.png", bbox_inches = "tight")
plt.show()
plt.close()

"""
plt.errorbar(x=cell_count, y=means_overall, yerr=stdev_overall, color="dodgerblue", alpha=0.3, zorder=0)
plt.plot(cell_count, dist_mean_list, '.', color="orange", zorder=1)

plt.title("Delaunay triangulation of GFP & RFP cells;\nEvolution of triangle edges sizes in a movie: 1105 frames")
plt.ylabel("Mean Triangle Edge Size [pixels]")
plt.xlabel("Cell Count per FOV")
plt.savefig("/Volumes/lowegrp/Data/Kristina/MDCK_90WT_10Sc_NoComp/17_07_24/pos13/Triangle_Edges_Cell_Count.png",
            bbox_inches = "tight")
plt.show()
plt.close()
"""


